# SCADA 취약점 프레임워크 개발 (4th)

## 1. 주제 소개
SCADA(스카다) : Supervisory Control And Data Acquisition의 약자로, 감시 제어 및 데이터 수집 시스템이라고 할 수 있다  
공장, 발전소, 수도 시설, 철도, 가스·석유 플랜트 같은 곳에서 기계나 설비를 원격으로 모니터링하고 제어하기 위해 사용된다  
따라서, SCADA는 물리적 설비(펌프, 변압기, 밸브 등)를 직접 제어하기 때문에 SCADA에서 터진 취약점은 물리적 피해로 직결된다  

사례 :  
- Stuxnet (2010): PLC를 표적해 원심분리기 동작을 변조한 대표적인 공격 사례
- 우크라이나 전력망 공격 (2015): 원격으로 변전소를 조작해 대규모 정전 유발한 운영기술(OT) 타깃 공격 사례

SCADA 취약점 프레임워크 개발 프로젝트는 SCADA에서 발생할 수 있는 취약점을  
**사전 식별(탐지) → 우선순위화(리스크 평가) → 보완(완화 조치 제시) → 검증(재검사)** 까지  
자동화 및 반복할 수 있게 해주는 체계(툴 + 프로세스 + 가이드)를 만드는 것이라고 추측해볼 수 있다


## 2. 주제 선정 이유
산업제어시스템의 보안 중요성이 증대되는 현실과, 과거 Stuxnet 공격이 제시한 운영기술(OT) 보안의 치명적 취약성에 깊은 인상을 받았기 때문이다

## 3. 탐구하려는 주제에 대한 결과물 정리

### 3.1 관련 표준 조사

#### 1. NIST SP 800-82 Rev. 3 — *Guide to Operational Technology (OT) Security*

* **요약:** NIST가 발행한 OT/ICS 보안 가이드의 최신 권고서로, OT의 안전 및 가용성 우선시 성향을 고려한 보안 통제와 설계와 운영 권고를 제공하며, 패치·네트워크 분리·접근통제·모니터링 등 실무적 지침이 포함된다
* **적용범위:** 모든 산업제어시스템(공장, 발전, 수처리 등)의 보안 아키텍처 설계와 운영 절차
* **실무포인트:** 비파괴(읽기 전용) 점검 권장, IT·OT 연계 시 위험관리, 표준 기반의 통제 매핑이 핵심

#### 2. ISA/IEC 62443 시리즈 — *Security for Industrial Automation and Control Systems (IACS)*

* **요약:** 산업자동화·제어시스템 보안을 위한 종합 표준 시리즈로, 조직(관리적), 시스템(프로젝트/제품 개발), 구성요소(제품 보안) 수준의 요구사항을 체계적으로 제시한다
* **적용범위:** IACS 설계·개발·운영에 대한 전수준 보안요구 정의(제품제조사, 시스템통합사, 운영기관 모두 대상)
* **실무포인트:** 보안요구를 설계 수명주기에 통합(secure-by-design), 역할·책임 정의 및 공급망 보안 요구 포함

#### 3. NERC CIP (Critical Infrastructure Protection) — 전력 분야 규제 표준

* **요약:** 북미 전력계통(Bulk Electric System)을 대상으로 하는 강제성 규제 표준 세트로 중요 자산 식별(CIP-002 등), 접근통제, 자산 보호, 사고 대응 절차 등을 규정하며, 전력사업체에 법적·규제적 요구사항으로 작동한다
* **적용범위:** 북미의 발전·송배전 사업자(법적 의무 대상으로 적용)
* **실무포인트:** 규제 준수(감사·증빙) 중심의 운영 절차 수립이 필요하며, 표준 이행을 위한 문서화·증적 확보가 중요

#### 4. ISO/IEC 27019 — *Information security controls for the energy utility industry*

* **요약:** ISO/IEC 27002(정보보호 통제)의 에너지 유틸리티(전력·가스·열 등) 적용 확장판으로, 제어 시스템과 연계된 정보보호 통제를 산업 환경 특성에 맞춰 구체화한 표준이다
* **적용범위:** 에너지 산업 내 정보보호(OT 포함) 통제 적용에 적합
* **실무포인트:** ISO 27001 기반의 관리체계와 연계해 OT 특화 통제를 도입할 때 유용하다


| 표준/지침                |         대상 영역 | 핵심 초점             |                                  법적 구속력 |
| -------------------- | ------------: | ----------------- | --------------------------------------: |
| NIST SP 800-82 Rev.3 |     OT/ICS 전반 | OT 특화 보안 통제·운영 지침 |   권고(미연방 기관 권고 영향력 큼)
| ISA/IEC 62443        | IACS 전 라이프사이클 | 설계·제품·운영 레벨 요구·구조 |      국제표준(권고/참조로 널리 채택)
| NERC CIP             |        전력(북미) | 중요자산보호·컴플라이언스     |             규제(법적 구속력)
| ISO/IEC 27019        |      에너지 유틸리티 | ISO27001 연계 OT 통제 |                    국제표준(권고)

---

### 3.2 SCADA 취약점 사례 "Stuxnet" 분석

#### 1. 개요
* Stuxnet은 **Windows 플랫폼을 매개로 SCADA 환경(특히 Siemens Step7/WinCC)** 를 목표로 한 고도화된 멀티모듈 악성코드이다  
공격의 최종 목적은 특정 PLC 구성(원심분리기 제어기)의 동작을 은밀히 교란하여 물리적 피해를 유발하는 것이었다
* 특징: 여러 **제로데이 취약점**의 동시 이용, PLC/STEP7 프로젝트·라이브러리 변조, PLC 쪽에 설치되는 **루트킷/은닉 기법**, 그리고 내부 네트워크 확산·P2P 업데이트 메커니즘 등 복합 기술이 결합되어 있다

#### 2. 공격 체인 분해

1. **초기 진입(Initial Access)**
   * 주된 매개: 감염된 USB(이른바 air-gap 횡단 수단) 및 네트워크 취약점 악용
   * 사용된 기법: LNK 취약점 등(아이콘 처리 취약점)처럼 사용자의 최소 상호작용만으로 코드 실행이 가능한 취약점이 사용되었다

2. **권한 상승·지속성(Privilege Escalation & Persistence)**
   * Stuxnet은 Windows 커널/OS 취약점들과 로컬 권한 상승 기법을 통해 높은 권한을 확보하고 자체 루트킷을 설치해 은닉·지속성을 유지했다

3. **측면 이동(Lateral Movement)**
   * 로컬 네트워크 내부에서 파일/서비스·RPC 취약점 등을 통해 확산, P2P 스타일의 업데이트 루틴으로 변형·명령을 전달해 네트워크 상의 다른 Windows 호스트로 확산하여 Step7이 설치된 시스템을 탐색하였다

4. **타깃 식별(Target Discovery)**
   * Stuxnet은 감염된 호스트에서 **Siemens Step7 프로젝트 파일·WinCC 구성**을 검색하여 타깃 여부를 판단(특정 PLC 모델·주파수 범위·VFD 제조사 등 조건 확인)하고, 타깃이 아니면 침묵 및 휴면

5. **PLC 감염(PLC compromise)**
   * Step7 프로젝트·라이브러리를 변조하여 PLC에 서명된 코드 블록(데이터 블록)을 삽입/수정했다
   * PLC 메모리(특정 DB 블록)에 악성 로직을 배치하고, 정상 모니터링 값은 가로채어 정상으로 보이게 마스킹하였다

6. **물리적 작동(Payload)**
   * 특정 운전 조건(예: 모터 회전수 범위)에서만 주기적으로 원심분리기의 속도를 변조하는 등 은밀한 물리적 교란을 발생시켜, 장비의 손상과 성능저하를 유도하였다

#### 3. 기술적 포인트
1. **다중 제로데이 활용:** 적은 수의 제로데이에 의존하지 않고 여러 제로데이를 조합해 초기 침투·권한 상승·확산을 안정적으로 수행했다는 점이 인상적이다
2. **조건부 페이로드(고정밀 타겟팅):** 환경을 측정하여 특정 조건(PLC 모델, VFD 벤더, 회전수 범위)이 충족될 때만 공격을 활성화하는 **안티-노이즈 전략**을 채택해 오탐이 감소하고 발견을 회피하였다
* **산업 소프트웨어 서브시스템 훼손:** Step7 프로젝트·라이브러리(예: s7otbxdx.dll과 같은 통신·라이브러리)를 후킹·변조해 PLC와 SCADA 사이의 신뢰 경로를 교란했다
* **루트킷·은닉 전략:** Windows·PLC 쪽 모두에서 은닉 기술을 사용해 탐지를 어렵게 만들고, 포렌식 증거를 제한하였다
* **전술적 안전성(Non-destructiveness until trigger):** 공격은 즉시 파괴적 행동을 하지 않고 장기간 은닉하다가 특정 시점·조건에서 페이로드를 실행하여 추적이나 대응을 어렵게 했다

## 4. 주제를 조사하고 난 이후 느낀점

SCADA 취약점 프레임워크 개발 프로젝트를 탐구하며, SCADA 보안이 단순한 기술적 문제가 아니라 조직·운영·정책이 결합된 복합적 과제임을 깨달았다  
