# Windows Driver 0-day Research (12기)

## 1. 주제 소개

Windows Driver 0-day 연구는 아직 알려지지 않은 취약점을 대상으로, 운영체제의 핵심 드라이버에서 보안 결함을 탐지하고 분석하는 것이다  
이를 통해 시스템 권한 상승, 원격 코드 실행 등의 공격 벡터를 이해하고 예방할 수 있다

## 2. 주제 선정 이유

Pwnable과 커널 익스플로잇에 관심이 있어 Windows 드라이버 0-day 연구를 주제로 선택했다

## 3. 탐구하려는 주제에 대한 결과물 정리

### CVE-2019-1458 분석

* **취약점 유형:** Win32k 커널 권한 상승 (로컬 권한 상승 / arbitrary pointer dereference)
* **발견 / 패치 시기:** 2019년 12월 패치에서 수정되었고 실제 공격(예: WizardOpium)에서 이용된 사례가 있다

#### 1. 원인 (root cause)
* Win32k 모듈이 **초기화되지 않은 변수/객체를 잘못 처리**하여 공격자가 커널 내 임의 포인터를 역참조(dereference)하도록 트리거할 수 있었다
* 이로 인해 제한적이지만 제어 가능한 커널 쓰기가 가능해진다

#### 2. 익스플로잇 개요
* 공격자는 사용자 권한으로 특수하게 조작한 객체(예: 비트맵 등)를 만들어 커널 메모리의 특정 주소를 역참조/쓰기하도록 유도할 수 있다
* 익스플로잇은 비트맵 객체를 이용한 ASLR 우회와 제한적 임의 쓰기(primitive)를 조합해 커널 읽기/쓰기와 최종 권한 상승을 달성할 수 있다

#### 3. 영향
* 로컬로 악성 코드를 실행할 수 있는 사용자가 해당 취약점을 이용하면 **SYSTEM 권한으로 코드 실행(권한 상승)** 이 가능해진다
* 샌드박스 탈출이나 브라우저 0-day와 결합하면 원격으로 심각한 침해로 이어질 수 있다

#### 4. 완화 및 대응
* Microsoft가 제공한 보안 업데이트 적용(패치)으로 해결하였다

## 4. 주제를 조사하고 난 이후 느낀점

주제를 조사하면서 평소 리눅스 기반에서만 Pwnable을 공부하다가 윈도우 커널 드라이버를 들여다보니 확실히 다른 점들이 많아 신기했다  
이런 경험을 통해 커널 내부 동작을 더 폭넓게 이해하게 되었고, 앞으로는 윈도우 Pwnable도 본격적으로 공부해 보고 싶다
